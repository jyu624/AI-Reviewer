# AI Reviewer - AWS S3 Storage Configuration
# S3 存储配置，使用 IAM 角色默认凭证

# =============================================================================
# S3 存储配置（使用 IAM 角色）
# =============================================================================
s3Storage:
  # AWS 区域
  region: "us-east-1"

  # 默认存储桶名称（可选，如果不设置，需要在调用时指定）
  bucketName: "your-bucket-name"

  # 不设置 accessKeyId 和 secretAccessKey
  # 将自动使用 AWS 默认凭证链（IAM 角色）

  # 性能配置
  maxConcurrency: 10         # 最大并发下载/上传数
  connectTimeout: 30000      # 连接超时（毫秒）
  readTimeout: 60000         # 读取超时（毫秒）
  maxRetries: 3              # 最大重试次数
  retryDelay: 1000           # 重试延迟（毫秒）

  # 高级配置（可选）
  useAccelerateEndpoint: false  # 是否使用传输加速端点
  usePathStyleAccess: false     # 是否使用路径样式访问
  # endpoint: ""                # 自定义端点（用于兼容 S3 的存储）

# =============================================================================
# AI 服务配置（Bedrock with IAM）
# =============================================================================
aiService:
  provider: "bedrock"
  model: "arn:aws:bedrock:us-east-1:590184013141:inference-profile/us.anthropic.claude-sonnet-4-5-20250929-v1:0"
  region: "us-east-1"
  maxTokens: 8000
  temperature: 0
  maxRetries: 2
  retryDelay: 1000
  maxConcurrency: 3

# =============================================================================
# 缓存配置
# =============================================================================
cache:
  enabled: true
  type: "file"
  ttlHours: 24
  maxSize: 1000
  cleanupIntervalMinutes: 60

  fileCache:
    baseDir: "${user.home}/.ai-reviewer-cache"
    indexFile: "cache-index.json"
    compression: true

# =============================================================================
# 文件扫描配置
# =============================================================================
fileScan:
  includePatterns:
    - "*.java"
    - "*.py"
    - "*.js"
    - "*.ts"
    - "*.go"
    - "*.rs"
    - "*.cpp"
    - "*.c"
    - "*.h"
    - "*.scala"
    - "*.kt"
    - "*.php"
    - "*.rb"
    - "*.cs"
    - "*.swift"
    - "*.dart"
    - "*.yaml"
    - "*.yml"
    - "*.json"
    - "*.xml"
    - "*.properties"
    - "*.md"
    - "*.txt"

  excludePatterns:
    - "**/target/**"
    - "**/build/**"
    - "**/dist/**"
    - "**/node_modules/**"
    - "**/.git/**"
    - "**/.idea/**"
    - "**/.vscode/**"
    - "**/logs/**"
    - "**/*.log"
    - "**/*.class"
    - "**/*.jar"
    - "**/*.war"

  maxFileSizeKB: 500
  maxTotalFiles: 1000

# =============================================================================
# 输出配置
# =============================================================================
output:
  format: "json"
  outputDir: "./review-reports"
  timestamp: true
  includeSourceCode: true
  detailedReport: true
  summaryReport: true

# =============================================================================
# 日志配置
# =============================================================================
logging:
  level: "INFO"
  file: "./logs/ai-reviewer.log"
  maxFileSize: "10MB"
  maxBackupIndex: 5
  console: true

# =============================================================================
# 使用场景示例
# =============================================================================
#
# 场景 1: 从 S3 下载项目进行审查
# java -jar ai-reviewer.jar --s3-source s3://my-bucket/projects/my-app/ --output ./reports
#
# 场景 2: 审查后将报告上传到 S3
# java -jar ai-reviewer.jar --path ./src --s3-upload s3://my-bucket/reports/
#
# 场景 3: 完整的 S3 工作流
# java -jar ai-reviewer.jar \
#   --s3-source s3://my-bucket/projects/my-app/ \
#   --s3-upload s3://my-bucket/reports/ \
#   --config config-s3-iam.yaml
#
# =============================================================================

